<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Tuna - </title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

        <link href="css/styles.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

  </head>
  <body>

  	<div class ="navbar navbar-default navbar-static-top">
  		<div class = "container">


            <div class=".navbar-header">

	            <!-- Title -->
	  			<a href ="/" class="navbar-brand">Tuna</a>

	  			<!-- Nav button-->
	  			<button class = "navbar-toggle" data-toggle = "collapse" data-target = ".navHeaderCollapse">
	  				<span class = "icon-bar"></span>
	  				<span class = "icon-bar"></span>
	  				<span class = "icon-bar"></span>
	  			</button>
	  		</div>

  			<div class = "collapse navbar-collapse navHeaderCollapse">
  				<ul class = "nav navbar-nav navbar-right">
  					<li><a href = "/">Home</a></li> 
  					<li><a href = "/search">Search</a></li> 
  					<li><a href = "/about">About</a></li> 
  				</ul>
  			</div>

  		</div>
  	</div>





    <!-- BODY -->
    <div class = "container">
      <div class = "jumbotron">
        <h1 id = "stile"></h1>
        <p id = "sinfo" align="center"><span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> Hold on! There are currently <span id="tunaCount">0</span> tuna in the net. </p>
      </div>
    </div>



    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>

     <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<script type="text/JavaScript">
      function get(name){
         if(name=(new RegExp('[?&]'+encodeURIComponent(name)+'=([^&]*)')).exec(location.search))
            return decodeURIComponent(name[1]);
      }

      function dispErr(){
          $("#stile").html("Error 4200");
          $("#sinfo").html("<img src='css/tuna.png' class='img-responsive' align='left'> Sorry! It looks like we can't catch any tuna right now; you may have an invalid song address. Please try again later. ");
      }

      var tunac = 0;

      function tunainc(){
        tunac++;
        document.getElementById("tunaCount").innerHTML = tunac;
      }
      function getSong(){
        var loading = setInterval(tunainc, 50); 


        song = get('id');
        if(song != undefined){
          $.getJSON( "api/song?id=" + song, function( data ) {
            var items = [];
            if(data["id"] == "error")
              dispErr();
            else{
              $.each( data, function( key, val ) {
                items.push( "<li id='" + key + "'>" + val + "</li>" );
              });
             
              $( "<ul/>", {
                "class": "my-new-list",
                html: items.join( "" )
              }).appendTo( "sinfo" );
          }
          }).always(function() {clearInterval(loading);});
        }
        else{
          dispErr();
        }

      }

      window.onload = getSong();



    </script>
  </body>
</html>